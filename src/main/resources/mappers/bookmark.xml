<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ssafy.homepjt.model.mapper.BookmarkMapper">

    <resultMap id="HouseInfoAll" type="HouseInfoDto">
        <result column="apt_code" property="aptCode"/>
        <result column="build_year" property="buildYear"/>
        <result column="road_name" property="roadName"/>
        <result column="road_name_bonbun" property="roadNameBonbun"/>
        <result column="road_name_bubun" property="roadNameBubun"/>
        <result column="road_name_seq" property="roadNameSeq"/>
        <result column="road_name_basement_code" property="roadNameBasementCode"/>
        <result column="road_name_code" property="roadNameCode"/>
        <!--        <result column="dong" property="dong"/>-->
        <!--        <result column="bonbun" property="bonbun"/>-->
        <!--        <result column="bubun" property="bubun"/>-->
        <result column="sigungu_code" property="sigunguCode"/>
        <result column="eubmyundong_code" property="eubmyundongCode"/>
        <result column="dong_code" property="dongCode"/>
        <result column="land_code" property="landCode"/>
        <result column="apartment_name" property="apartmentName"/>
        <!--        <result column="jibun" property="jibun"/>-->
        <!--        <result column="lon" property="lon"/>-->
        <!--        <result column="lat" property="lat"/>-->
        <result column="view_cnt" property="viewCnt"/>
        <result column="like_cnt" property="likeCnt"/>
    </resultMap>

    <sql id="houseInfoColumns">
        ${alias}.apt_code, ${alias}.build_year, ${alias}.road_name, ${alias}.road_name_bonbun, ${alias}.road_name_bubun, ${alias}.road_name_seq, ${alias}.road_name_basement_code,
        ${alias}.road_name_code, ${alias}.dong, ${alias}.bonbun, ${alias}.bubun, ${alias}.sigungu_code, ${alias}.eubmyundong_code, ${alias}.dong_code, ${alias}.land_code, ${alias}.apartment_name, ${alias}.jibun,
        ${alias}.lon, ${alias}.lat, ${alias}.view_cnt, ${alias}.like_cnt
    </sql>

    <!-- 관심 상품 등록 -->
    <insert id="insertBookmarkApt">
        insert into bookmark_apt(member_id, apt_code)
        values (#{memberId}, #{aptCode})
    </insert>

    <!-- 관심 상품 목록 보기 -->
    <select id="selectBookmarkApt" resultMap="HouseInfoAll">
        select
        <include refid="houseInfoColumns">
            <property name="alias" value="h"/>
        </include>
        from houseinfo h join bookmark_apt ba on h.apt_code = ba.apt_code
        where ba.member_id = #{memberId}
    </select>

    <!-- 관심 상품 삭제 -->
    <delete id="deleteBookmarkApt" parameterType="int">
        delete
        from bookmark_apt
        where id = #{bookmarkAptId}
    </delete>

    <!-- 관심 경로 목록 보기 -->
</mapper>